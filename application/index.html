<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<!--
  This template is a basic one for a Highcharts chart.

  See: http://www.highcharts.com/
-->

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>MinnPost Interactive Project</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <script type="text/javascript">var _sf_startpt=(new Date()).getTime()</script>
  <link rel="shortcut icon" href="http://www.minnpost.com//sites/default/themes/siteskin/favicon.ico" type="image/x-icon" />
  <meta name="viewport" content="width=device-width, initial-scale=1"></meta>


  <!--
    The area before the START: Embeddable is used to make the
    project act as much like the MinnPost site as possible
    to ensure best quality and ease of local development.
    
    The following links are to cached collections of
    CSS and JS and will change when the cache is cleared on
    the site.
    
    So, if your links are NOT MinnPost red, then you'll probably
    have to update this.
  -->
  <link type="text/css" rel="stylesheet" media="all" href="http://www.minnpost.com/sites/default/files/css/css_e1e628a1d1af71eb80119578f445aefe.css" />
  <link type="text/css" rel="stylesheet" media="screen" href="http://www.minnpost.com/sites/default/files/css/css_7c21f8513fb5bed4b20bcdfbd3425599.css" />
  <link type="text/css" rel="stylesheet" media="print" href="http://www.minnpost.com/sites/default/files/css/css_fcea2525eb0713a66c9fd404a556659e.css" />
  <!--[if IE]>
    <link rel="stylesheet" href="http://www.minnpost.com/sites/default/themes/derma/inc/css/ie.css?n" type="text/css">
  <![endif]-->
  
  <script type="text/javascript" src="http://www.minnpost.com/sites/default/files/js/js_9374db1ff1197a2d746a97396ed85cad.js"></script>
  <script type="text/javascript">
  <!--//--><![CDATA[//><!--
  jQuery.extend(Drupal.settings, {"basePath":"\/","combineBlocks":[["#block-views-most_viewed_by_taxonomy-block","#block-views-most_commented_articles-block_1"],["#block-views-most_viewed_by_node_type-block","#block-views-most_commented_blogs-block_1"],["#block-views-most_viewed_by_node_type-block","#block-views-most_commented_articles-block_1"]],"chartbeat":{"uid":27923,"domain":"minnpost.com","authors":"Tom Nehil,Alan Palazzolo","sections":"Data \u0026 Maps","title":"Build your own sales tax policy for Dayton\u0026#039;s new budget"},"googleanalytics":{"trackOutgoing":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls|xml|z|zip"},"addthis":{"config_default":{"services_toolbox":"facebook_like_counter, tweet, print, email","services_compact":"","services_expanded":"","ui_cobrand":"","ui_header_color":"#000000","ui_header_background":"#FFFFFF","ui_click":true,"ui_delay":"","ui_use_addressbook":0,"pubid":"xa-4e2cfd1147868c4e","data_track_clickback":0,"data_ga_tracker":0,"ui_use_css":true,"data_use_cookies":true,"ui_language":"en","data_use_flash":true},"share_default":{"templates":{"twitter":""}}}});
  //--><!]]>
  </script>
    
</head>
<body class="not-front logged-in page-node node-type-article one-sidebar sidebar-right admin-nw admin-vertical admin-df  section-data section-data-id-2012 section-data-id-2012-id-05 section-data-id-2012-id-05-how-we-built-legislative-bill-explorer one-sidebar sidebar-right">
<div class="outside-embeddable-container">



  <!-- 
    START: Embeddable
    
    This is where you start copying to embed into the
    content.  For full width articles, keep these classes
    on the following div (this ensures the correct
    font sizes).  If used in a regular article, remove
    the classes.
    
    For references, the classes are:
    node-body fieldlayout node-field-body
  -->
  <div class="node-body fieldlayout node-field-body">
  
    <!--
      Include any library or external CSS files below.
    -->
    <style type="text/css">
      /* @import url('https://s3.amazonaws.com/data.minnpost/js/flurid-2.1/flurid.min.css'); */
    </style>
    
    
    <!--
      Include styles that are specific to your project.
      Do try to be specific as not to screw up styles
      on the site.
    -->
    <style type="text/css">
      .interactive-container  {
        max-width: 960px;
        margin: 0 auto;
        padding-top: 1em;
      }
      .interactive-container .clear {
        clear: both;
      }
      .interactive-container .js-dependent,
      .interactive-container .hidden {
        display: none;
      }
      .interactive-container .footnote {
        font-size: .75em;
        font-style: italic;
        color: #414141;
        margin-top: 3em;
        border-top: 1px solid #BCBCBC;
        padding-top: 1em;
      }
      .interactive-container .loading-general {
        width: 100%;
        text-align: center;
        padding: 2em 2em;
        color: #ABABAB;
        vertical-align: middle;
        height: 100%;
        line-height: 100%;
      }
      .interactive-container .loading-general span {
        padding: 10px 5px 10px 40px;
        background: transparent url('https://s3.amazonaws.com/data.minnpost/projects/2012-mn-election-results/images/ajax-loader.gif') center left no-repeat;
        vertical-align: middle;
        height: 100%;
        line-height: 100%;
      }
      
      .interactive-container .number {
        font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
      }
      
      .interactive-container .highchart-container {
        width: 100%;
        height: 500px;
        margin-bottom: 1em;
      }
      
      /**
       * Begin custom styles.
       */
      
      /**
       * Responsive creen size styles
       */
      @media screen and (max-width: 960px) {
      }
    </style>
    
    <!--
      The following are styles specific to:
        Less than or equal to IE 8,
        Less than or equal to IE 7
    -->
    
    <!--[if lte IE 8]>
      <style type="text/css">
      </style>
    <![endif]-->
    
    <!--[if lte IE 7]>
      <style type="text/css">
      </style>
    <![endif]-->
    


    <!--
      This is the HTML that will be output.  This
      container ensures that your container acts
      the MinnPost site as much as possible.
      
      Change the ID so that selectors will be specific
      to your project.
    -->
    <div class="interactive-container" id="minnpost-project-name">
      <noscript>
        <p>This application requires Javascript which is used to make your web browser more interactive.  If this message does not go away, please consider enabling Javascript.  Here are <a href="http://www.enable-javascript.com/" target="_blank">instructions on how to enable JavaScript in your web browser</a>.</p>
      </noscript>
      
      <div class="base-container">
        <!--
          This is where your main HTML should go.
        -->
        
        <div>
          <form>
            <label for="neighborhood-select">Neighborhood list:</label>
            <select name="neighborhood-select" id="neighborhood-select">
              <option value="none">None</option>
            </select>
            
            <label for="max-select">Max:</label>
            <select name="max-select" id="max-select">
              <option value="50">50</option>
              <option value="100">100</option>
              <option value="150">150</option>
              <option value="200">200</option>
              <option value="250">250</option>
            </select>
          </form>
        </div>
        <div class="highchart-container" id="chart-example"></div>
      </div>
      
      <div class="footnote">
        <p>Link to specific data sources.  Use as specific URL as you can and use the _blank target so that the link open in a new window. <a href="http://google.com" target="_blank">Google</a>.  Code, techniques, and data on <a href="https://github.com/MinnPost" target="_blank">Github</a>.</p>
      </div>
    </div>
    
    
    <!--
      The following are templates that will be used
      through Javascript.  They should be written in
      Underscore.js templating markup.
      
      See: http://underscorejs.org/#template
    -->
    <script id="template-loading" type="text/template">
      <div class="loading-general-container">
        <div class="loading-general"><span>Loading...</span></div>
      </div>
    </script>
    


    <!-- 
      Include Javascript libraries here.
      
      jQuery 1.3.2 is included to best mimic the MinnPost site.
      Unfortunately we don't have much control over the jQuery version
      or anyway to keep it contained.  This means that we use a
      version of jQuery that has been renamed to jQueryCustom.
      It's annoying but ensures that there are no JS errors on the
      page that can cause all types of different problems,
      while being able to use a newer version of jQuery.
      
      See: https://github.com/MinnPost/jquery-custom
      
      JS and other relevant libraries are hosted on our
      AWS S3 account.  This ensures we do not have to
      embed them or otherwise manage them on the MinnPost
      site which would be a pain.  We can also leverage
      using the same source across projects.
      
      You are welcome to use hosted/CDN versions of
      libraries, but do ensure you are using a specific
      version.  DO NOT use the latest, or latest-stable,
      or development versions of hosted libraries
      as they are subject to change and will eventutally
      break, creating more work for us.
    -->
    <script type="text/javascript">
      window.jQuery || document.write('<script type="text/javascript" src="https://s3.amazonaws.com/data.minnpost/js/jquery-1.3.2/jquery-1.3.2.min.js"><\/script>')
    </script>
    <script type="text/javascript" src="https://s3.amazonaws.com/data.minnpost/js/jquery-custom-master-20120606/jquery-1.7.2.custom.min.js"></script>
    <script type="text/javascript" src="https://s3.amazonaws.com/data.minnpost/js/underscore-1.4.4/underscore-min.js"></script>
    <script type="text/javascript" src="https://s3.amazonaws.com/data.minnpost/js/jquery.jsonp-2.4.0/jquerycustom.jsonp-2.4.0.min.js"></script>


    <!--
      Using hosted CDN version of Highcharts, note that
      it is a specific version.
    -->
    <script type="text/javascript" src="http://code.highcharts.com/2.2.4/highcharts.js"></script>
    <script type="text/javascript" src="http://code.highcharts.com/2.2.4/modules/exporting.js"></script>


    <!--
      Custom Javascript should go here.  It is
      important to use jQueryCustom in this closure
      way so that you are not using the original
      jQuery as $.
      
      Please follow the JS coding guidelines that
      can be found here:
      https://github.com/MinnPost/javascript
    -->
    <script type="text/javascript">
      jQueryCustom.noConflict();
    
      (function($, w, undefined) {
        $(document).ready(function() {
          var neighborhoodListURL = "https://api.scraperwiki.com/api/1.0/datastore/sqlite?format=jsondict&name=minneapolis_aggregate_crime_data&query=SELECT%20DISTINCT%20neighborhood_key%20FROM%20swdata%20ORDER%20BY%20neighborhood_key&callback=?";
          var neighborhoodURL = "https://api.scraperwiki.com/api/1.0/datastore/sqlite?format=jsondict&name=minneapolis_aggregate_crime_data&query=SELECT%20*%20FROM%20%60swdata%60%20WHERE%20neighborhood_key%20%3D%20'[[[NEIGHBORHOOD]]]'&callback=?";
          
          // Compiling templates to be efficient
          var templates = {
            loading: _.template($('#template-loading').html())
          };
          
          // Mark as loading while getting data
          $('#chart-example').html(templates.loading({ }));
          
          // Handle new neighborhood
          var updateChart = function(neighborhood, max) {
            $('#chart-example').html(templates.loading({ }));
            
            $.jsonp({
              url: neighborhoodURL.replace('[[[NEIGHBORHOOD]]]', neighborhood),
              success: function(data) {
                var seriesTypes = ['homicide', 'rape', 'robbery', 'agg_assault', 
                  'burglary', 'larceny', 'auto_theft', 'arson']
                  
                var series = [];
                
                _.each(seriesTypes, function(t) {
                  series.push({
                    name: t,
                    data: _.map(data, function(d) {
                      return [
                        Date.UTC(d.year, d.month, 1),
                        parseInt(d[t])
                      ]
                    })
                  });
                });
                
                var exampleChart = new Highcharts.Chart({
                  chart: {
                    renderTo: 'chart-example',
                    type: 'spline'
                  },
                  title: {
                    text: 'Neighborhood crime data'
                  },
                  xAxis: {
                    type: 'datetime',
                  },
                  yAxis: {
                    min: 0,
                    max: max
                  },
                  plotOptions: {
                    spline: {
                      marker: {
                        enabled: false
                      },
                    }
                  },
                  series: series
                });
                
              },
              error: function(e) {
                console.log('error');
              }
            });
          };
          
          // Get list
          $.jsonp({
            url: neighborhoodListURL,
            success: function(data) {
              _.each(data, function(d) {
                $('#neighborhood-select').append($('<option value="' + d.neighborhood_key + '">' + d.neighborhood_key + '</option>'));
              });
              $('#chart-example').html('<p><br /><br />Select neighborhood...</p>');
              
              $('#neighborhood-select').on('change', function(e) {
                updateChart($(this).val(), parseInt($('#max-select').val()) || 50);
              });
            }
          });
          
          
          
        });
      })(jQueryCustom, window);
    </script>
  </div>
  <!--
    END: Embeddable
  
    Stop copying.
  -->



</div>
</body>
</html>